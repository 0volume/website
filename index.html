<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Post-it Board</title>
    <style>
        * { -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: #8B5A2B; font-family: sans-serif; overflow: hidden; touch-action: none; }
        #board { width: 100vw; height: 100vh; position: relative; }
        .note { position: absolute; width: 140px; height: 140px; padding: 10px; font-size: 12px; box-shadow: 2px 2px 8px rgba(0,0,0,0.3); cursor: pointer; display: flex; align-items: center; justify-content: center; text-align: center; word-break: break-word; user-select: none; }
        .yellow { background: #fef3bd; }
        .pink { background: #ffd1dc; }
        .blue { background: #cce5ff; }
        .green { background: #d4edda; }
        .lavender { background: #e6e6fa; }
        .peach { background: #ffe5d9; }
        #add { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background: #3498db; border-radius: 50%; border: none; color: white; font-size: 30px; cursor: pointer; box-shadow: 2px 2px 10px rgba(0,0,0,0.3); z-index: 100; }
        #settingsBtn { position: fixed; bottom: 20px; left: 20px; width: 40px; height: 40px; background: rgba(255,255,255,0.3); border-radius: 50%; border: none; color: white; font-size: 18px; cursor: pointer; z-index: 100; }
        #modal, #pinModal, #settingsModal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 200; align-items: center; justify-content: center; }
        #modal.open, #pinModal.open, #settingsModal.open { display: flex; }
        .modal-box { background: white; padding: 20px; border-radius: 10px; width: 80%; max-width: 300px; }
        #noteInput { width: 100%; height: 80px; font-size: 16px; padding: 10px; box-sizing: border-box; border: 2px solid #ddd; border-radius: 5px; resize: none; }
        .btns { display: flex; gap: 10px; margin-top: 10px; }
        .btns button { flex: 1; padding: 10px; border: none; border-radius: 5px; font-size: 14px; cursor: pointer; }
        .btn-cancel { background: #ddd; }
        .btn-save { background: #27ae60; color: white; }
        #keyboard { display: grid; grid-template-columns: repeat(10, 1fr); gap: 3px; margin-top: 10px; }
        .key { padding: 8px 0; background: #eee; border: none; border-radius: 3px; font-size: 12px; cursor: pointer; }
        .key:active { background: #ccc; }
        .key-space { grid-column: span 6; }
        input[type="text"], input[type="password"] { width: 100%; padding: 10px; font-size: 14px; border: 2px solid #ddd; border-radius: 5px; box-sizing: border-box; margin-bottom: 10px; }
        #msg { position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 10px 20px; border-radius: 20px; display: none; z-index: 500; }
        #msg.show { display: block; }
        #deleteHint { position: fixed; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(231, 76, 60, 0.9); color: white; padding: 8px 16px; border-radius: 20px; font-size: 12px; display: none; z-index: 400; }
        #deleteHint.show { display: block; }
        .del-btn { position: absolute; top: 2px; right: 2px; width: 20px; height: 20px; background: #e74c3c; color: white; border: none; border-radius: 50%; font-size: 12px; line-height: 20px; text-align: center; cursor: pointer; display: none; }
        .show-del .del-btn { display: block; }
    </style>
</head>
<body>
    <div id="board"></div>
    <button id="add">+</button>
    <button id="settingsBtn">⚙</button>
    <div id="modal">
        <div class="modal-box">
            <textarea id="noteInput" placeholder="Write note..." maxlength="200"></textarea>
            <div id="keyboard">
                <button class="key" data="q">q</button><button class="key" data="w">w</button><button class="key" data="e">e</button><button class="key" data="r">r</button><button class="key" data="t">t</button><button class="key" data="y">y</button><button class="key" data="u">u</button><button class="key" data="i">i</button><button class="key" data="o">o</button><button class="key" data="p">p</button>
                <button class="key" data="a">a</button><button class="key" data="s">s</button><button class="key" data="d">d</button><button class="key" data="f">f</button><button class="key" data="g">g</button><button class="key" data="h">h</button><button class="key" data="j">j</button><button class="key" data="k">k</button><button class="key" data="l">l</button><button class="key" data="z">z</button><button class="key" data="x">x</button><button class="key" data="c">c</button>
                <button class="key" data="v">v</button><button class="key" data="b">b</button><button class="key" data="n">n</button><button class="key" data="m">m</button><button class="key" data="⌫">⌫</button><button class="key key-space" data=" ">space</button><button class="key" style="background:#3498db;color:white;grid-column:span 4" data="save">SAVE</button>
            </div>
            <div class="btns"><button class="btn-cancel" id="cancelBtn">Cancel</button></div>
        </div>
    </div>
    <div id="pinModal">
        <div class="modal-box">
            <p style="text-align:center">Enter PIN</p>
            <input type="password" id="pinInput" maxlength="4" style="width:100%;padding:10px;font-size:24px;text-align:center;letter-spacing:10px" placeholder="••••">
            <div class="btns"><button class="btn-cancel" id="pinCancelBtn">Cancel</button></div>
        </div>
    </div>
    <div id="settingsModal">
        <div class="modal-box">
            <p style="text-align:center;font-weight:bold;margin-bottom:15px">Settings</p>
            <label style="font-size:12px;color:#666">GitHub Token (for sync):</label>
            <input type="password" id="tokenInput" placeholder="ghp_xxxx...">
            <label style="font-size:12px;color:#666">Gist ID (optional):</label>
            <input type="text" id="gistInput" placeholder="Leave empty for new">
            <div class="btns"><button class="btn-cancel" id="settingsCancelBtn">Cancel</button><button class="btn-save" id="settingsSaveBtn">Save</button></div>
        </div>
    </div>
    <div id="msg"></div>
    <div id="deleteHint">Admin: tap × to delete</div>
    <script>
        const COLORS = ['yellow','pink','blue','green','lavender','peach'];
        const PIN = '1234';
        let notes = [], adminMode = false, lastTap = 0, token = localStorage.getItem('pt'), gistId = localStorage.getItem('pg') || '';
        const board = document.getElementById('board'), addBtn = document.getElementById('add'), settingsBtn = document.getElementById('settingsBtn'), modal = document.getElementById('modal'), pinModal = document.getElementById('pinModal'), settingsModal = document.getElementById('settingsModal'), noteInput = document.getElementById('noteInput'), msg = document.getElementById('msg'), deleteHint = document.getElementById('deleteHint');
        
        function init() {
            notes = JSON.parse(localStorage.getItem('notes') || '[]');
            if (!notes.length) notes = [{id:'1',text:'Welcome! Tap + to add notes',color:'yellow',x:30,y:60},{id:'2',text:'Double-tap + for admin (PIN: 1234)',color:'pink',x:180,y:80}];
            render();
            addBtn.onclick = () => { modal.classList.add('open'); setTimeout(() => noteInput.focus(), 100); };
            let pt; settingsBtn.onmousedown = () => { pt = setTimeout(openSettings, 800); }; settingsBtn.onmouseup = () => clearTimeout(pt);
            document.getElementById('cancelBtn').onclick = () => modal.classList.remove('open');
            document.getElementById('pinCancelBtn').onclick = () => pinModal.classList.remove('open');
            document.getElementById('settingsCancelBtn').onclick = () => settingsModal.classList.remove('open');
            document.getElementById('settingsSaveBtn').onclick = saveSettings;
            document.querySelectorAll('.key').forEach(k => k.onclick = () => { const d = k.dataset.data; if (d === '⌫') noteInput.value = noteInput.value.slice(0,-1); else if (d === 'save') saveNote(); else if (noteInput.value.length < 200) noteInput.value += d; });
            addBtn.ontouchend = (e) => { e.preventDefault(); const now = Date.now(); if (now - lastTap < 350) { pinModal.classList.add('open'); document.getElementById('pinInput').value = ''; document.getElementById('pinInput').focus(); } lastTap = now; };
            document.getElementById('pinInput').oninput = (e) => { if (e.target.value.length === 4) { if (e.target.value === PIN) { adminMode = !adminMode; showDeleteHint(); showMsg(adminMode ? 'Admin ON' : 'Admin OFF'); render(); pinModal.classList.remove('open'); } else { showMsg('Wrong PIN'); e.target.value = ''; } } };
        }
        
        async function saveNoteToWeb() {
            const text = noteInput.value.trim();
            if (!text) { showMsg('Write something!'); return; }
            const pos = { x: 20 + Math.random() * (window.innerWidth - 180), y: 60 + Math.random() * (window.innerHeight - 220) };
            notes.push({ id: Date.now().toString(36), text: text, color: COLORS[Math.floor(Math.random() * COLORS.length)], x: pos.x, y: pos.y });
            localStorage.setItem('notes', JSON.stringify(notes));
            if (token) {
                try {
                    const content = JSON.stringify({ notes: notes, version: 1 });
                    if (gistId) { await fetch('https://api.github.com/gists/' + gistId, { method: 'PATCH', headers: { 'Authorization': 'token ' + token, 'Content-Type': 'application/json' }, body: JSON.stringify({ files: { 'notes.json': { content } } }) }); }
                    else { const res = await fetch('https://api.github.com/gists', { method: 'POST', headers: { 'Authorization': 'token ' + token, 'Content-Type': 'application/json' }, body: JSON.stringify({ description: 'Post-it Notes', public: false, files: { 'notes.json': { content } } }) }); const data = await res.json(); gistId = data.id; localStorage.setItem('pg', gistId); }
                } catch(e) {}
            }
            modal.classList.remove('open');
            render();
            showMsg('Note saved!');
        }
        
        function render() {
            board.innerHTML = '';
            notes.forEach(n => { const el = document.createElement('div'); el.className = 'note ' + n.color + (adminMode ? ' show-del' : ''); el.style.left = n.x + 'px'; el.style.top = n.y + 'px'; el.innerHTML = '<button class="del-btn" data-id="'+n.id+'">×</button><div>'+n.text+'</div>'; el.querySelector('.del-btn').onclick = (e) => { e.stopPropagation(); if (adminMode) { notes = notes.filter(x => x.id !== n.id); localStorage.setItem('notes', JSON.stringify(notes)); render(); showMsg('Deleted'); } }; board.appendChild(el); });
        }
        
        function openSettings() { document.getElementById('tokenInput').value = token; document.getElementById('gistInput').value = gistId; settingsModal.classList.add('open'); }
        function saveSettings() { token = document.getElementById('tokenInput').value.trim(); gistId = document.getElementById('gistInput').value.trim(); if (token) { localStorage.setItem('pt', token); localStorage.setItem('pg', gistId); showMsg('Settings saved!'); } settingsModal.classList.remove('open'); }
        function showMsg(t) { msg.textContent = t; msg.classList.add('show'); setTimeout(() => msg.classList.remove('show'), 2000); }
        function showDeleteHint() { if (adminMode) { deleteHint.classList.add('show'); setTimeout(() => deleteHint.classList.remove('show'), 3000); } }
        init();
    </script>
</body>
</html>
